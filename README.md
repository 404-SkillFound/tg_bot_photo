# Проект: tg_bot_photo
## Описание: 
Обработка фотографий через телеграм + API
# Структура проекта
```
tg_photo_bot/                     # 🎯 КОРЕНЕВОЙ КАТАЛОГ ПРОЕКТА
│
├── 📁 photo_bot/                 # 🎪 ОСНОВНОЙ ПАКЕТ ПРИЛОЖЕНИЯ
│   │
│   ├── 📁 domain/                # 🧠 ДОМЕННЫЙ СЛОЙ (Бизнес-логика)
│   │   │                          # Здесь живут правила предметной области
│   │   ├── 📁 entities/           # 📦 СУЩНОСТИ ПРЕДМЕТНОЙ ОБЛАСТИ
│   │   │   ├── user_session.py    # 💾 Сессия пользователя (данные + поведение)
│   │   │   └── image_processing.py # 🖼️ Обработка изображения (бизнес-правила)
│   │   │
│   │   ├── 📁 services/           # 🔧 ДОМЕННЫЕ СЕРВИСЫ
│   │   │   └── image_processing_service.py # Сложная бизнес-логика
│   │   │
│   │   ├── 📁 value_objects/      # 🎯 ЦЕННОСТНЫЕ ОБЪЕКТЫ (неизменяемые)
│   │   │   ├── image_format.py    # 📄 Формат изображения (JPEG/PNG/WEBP)
│   │   │   ├── processing_type.py # ⚙️ Тип обработки (удалить/изменить фон)
│   │   │   └── filter_type.py     # 🎨 Тип фильтра (сепия, черно-белый)
│   │   │
│   │   └── exceptions.py          # 🚨 ДОМЕННЫЕ ИСКЛЮЧЕНИЯ
│   │
│   ├── 📁 application/            # 🚀 СЛОЙ ПРИЛОЖЕНИЯ (Use Cases)
│   │   │                          # Оркестрирует работу домена и инфраструктуры
│   │   ├── 📁 dtos/               # 📤📥 DATA TRANSFER OBJECTS
│   │   │   ├── image_request.py   # 📨 Запрос на обработку изображения
│   │   │   ├── image_response.py  # 📬 Результат обработки
│   │   │   └── telegram_update.py # 📱 Данные от Telegram
│   │   │
│   │   ├── 📁 interfaces/         # 🔌 ИНТЕРФЕЙСЫ (Ports)
│   │   │   ├── image_processor.py # 🖼️ Интерфейс обработчика изображений
│   │   │   ├── session_repository.py # 💾 Интерфейс хранилища сессий
│   │   │   └── telegram_client.py # 🤖 Интерфейс Telegram клиента
│   │   │
│   │   ├── 📁 use_cases/          # 🎯 СЦЕНАРИИ ИСПОЛЬЗОВАНИЯ
│   │   │   ├── process_image.py   # 🖼️ Обработать изображение
│   │   │   ├── handle_telegram_message.py # 📨 Обработать сообщение
│   │   │   └── manage_session.py  # 💾 Управление сессиями
│   │   │
│   │   └── mappers.py             # 🔄 ПРЕОБРАЗОВАТЕЛИ ДАННЫХ
│   │
│   ├── 📁 presentation/           # 🎭 СЛОЙ ПРЕДСТАВЛЕНИЯ (UI/API)
│   │   │                          # Взаимодействие с внешним миром
│   │   ├── 📁 api/                # 🌐 WEB API
│   │   │   └── 📁 rest/           # 📡 REST API
│   │   │       ├── 📁 v1/         # 1️⃣ ВЕРСИЯ API v1
│   │   │       │   ├── 📁 controllers/ # 🎮 КОНТРОЛЛЕРЫ
│   │   │       │   │   ├── telegram_webhook.py # 📞 Webhook от Telegram
│   │   │       │   │   └── health_check.py # ❤️ Проверка здоровья
│   │   │       │   └── routers.py # 🛣️ МАРШРУТЫ API
│   │   │       └── middlewares.py # 🛡️ ПРОМЕЖУТОЧНОЕ ПО
│   │   │
│   │   ├── 📁 telegram/           # 🤖 TELEGRAM ИНТЕРФЕЙС
│   │   │   ├── handlers/          # 🎯 ОБРАБОТЧИКИ СООБЩЕНИЙ
│   │   │   │   ├── message_handlers.py # 📝 Текстовые сообщения
│   │   │   │   ├── photo_handlers.py   # 🖼️ Фотографии
│   │   │   │   └── command_handlers.py # ⌨️ Команды (/start, /help)
│   │   │   └── bot.py             # 🤖 ОСНОВНОЙ КЛАСС БОТА
│   │   │
│   │   └── __init__.py
│   │
│   ├── 📁 infrastructure/         # ⚙️ ИНФРАСТРУКТУРНЫЙ СЛОЙ
│   │   │                          # Реализация интерфейсов, работа с внешними сервисами
│    │   ├── 📁 image_processing/   # 🖼️ ОБРАБОТКА ИЗОБРАЖЕНИЙ
│    │   │   ├── photoroom_client.py # ☁️ Клиент Photoroom API
│    │   │   ├── pillow_processor.py # 🎨 Локальная обработка через Pillow
│    │   │   └── image_processor_impl.py # 🔧 Адаптер для выбора процессора
│    │   │
│    │   ├── 📁 session/            # 💾 ХРАНЕНИЕ СЕССИЙ
│    │   │   └── memory_session_repo.py # 🧠 Хранилище в оперативной памяти
│    │   │
│    │   ├── 📁 telegram/           # 🤖 TELEGRAM ИНТЕГРАЦИЯ
│    │   │   └── telegram_client_impl.py # 📡 Реализация Telegram клиента
│    │   │
│    │   ├── 📁 config/             # ⚙️ КОНФИГУРАЦИЯ
│    │   │   ├── settings.py        # 🔧 Настройки приложения
│    │   │   └── __init__.py
│    │   │
│    │   └── __init__.py
│    │
│    ├── 📁 config/                 # 🎛️ КОНФИГУРАЦИЯ И DI
│    │   ├── 📁 ioc/                # 💉 DEPENDENCY INJECTION
│    │   │   ├── di.py              # 🏗️ Контейнер зависимостей
│    │   │   └── providers.py       # 🔌 Провайдеры зависимостей
│    │   ├── logging.py             # 📝 НАСТРОЙКА ЛОГИРОВАНИЯ
│    │   └── __init__.py
│    │
│    └── main.py                    # 🚀 ТОЧКА ВХОДА ПРИЛОЖЕНИЯ
│
├── 📁 tests/                          # 🧪 ТЕСТЫ
│   ├── 📁 unit/                       # 🧩 Модульные тесты
│   ├── 📁 integration/                # 🔗 Интеграционные тесты
│   └── 📁 e2e/                        # 🏁 End-to-end тесты
│
├── requirements.txt                   # 📦 ЗАВИСИМОСТИ ПРОЕКТА
├── .env                               # 🔐 ПЕРЕМЕННЫЕ ОКРУЖЕНИЯ
├── .env.example                       # 📋 ПРИМЕР НАСТРОЕК
├── .gitignore                         # 🙈 ИГНОРИРУЕМЫЕ ФАЙЛЫ
└── run.py                             # ▶️ СКРИПТ ЗАПУСКА

```
# Подробнее про слои

🧠 Domain Layer (Предметная область)
* Сущности: Пользовательская сессия, Обработка изображения
* Ценностные объекты: Формат изображения, Тип фильтра, Тип обработки
* Бизнес-правила: Валидация изображений, Логика сессий
* ! Не зависит от: БД, API, Фреймворков

🚀 Application Layer (Сценарии использования)
* Use Cases: Обработать изображение, Управлять сессией
* DTO: Структуры данных для передачи между слоями
* Интерфейсы: Контракты для инфраструктуры
* Координирует: Работу домена и инфраструктуры

🎭 Presentation Layer (Интерфейсы)
* REST API: Webhook для Telegram, Health check
* Telegram Bot: Обработчики сообщений, команд, фото
* Преобразует: Внешние запросы → DTO → Use Cases

⚙️ Infrastructure Layer (Внешние сервисы)
* Photoroom API: Удаление и изменение фона
* Pillow: Локальная обработка изображений
* Хранилище: Сессии в памяти
* Telegram: Клиент для отправки сообщений

Запуск проекта:
```bash
uvicorn photo_bot.main:app --reload
```